<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ví Pi - Đầy đủ</title>
    <!-- Google Fonts for Inter -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- TradingView Widget -->
    <script src="https://s3.tradingview.com/tv.js"></script>
    <!-- Local CSS -->
    <style>
      /* Smooth Scroll */
      html {
        scroll-behavior: smooth;
      }

      /* Parallax Background */
      body {
        background: linear-gradient(135deg, #e0e7ff, #c3dafe, #a5b4fc);
        position: relative;
        overflow-x: hidden;
        animation: gradientShift 15s ease infinite;
      }

      @keyframes gradientShift {
        0% {
          background-position: 0% 50%;
        }
        50% {
          background-position: 100% 50%;
        }
        100% {
          background-position: 0% 50%;
        }
      }

      /* Dark Mode */
      .dark-mode {
        background: linear-gradient(135deg, #1a202c, #2d3748, #4a5568);
        color: #e2e8f0;
      }
      .dark-mode .bg-white {
        background: rgba(45, 55, 72, 0.85);
        backdrop-filter: blur(10px);
      }
      .dark-mode .text-gray-800 {
        color: #ffffff;
      }
      .dark-mode .text-gray-500,
      .dark-mode .text-gray-600 {
        color: #a0aec0;
      }
      .dark-mode .bg-gray-200 {
        background: #4a5568;
      }
      .dark-mode .hover:bg-gray-300 {
        background: #718096;
      }
      .dark-mode .border-gray-300 {
        border-color: #4a5568;
      }
      .dark-mode .btn:hover {
        filter: brightness(1.2);
        box-shadow: 0 0 15px rgba(96, 165, 250, 0.5);
      }
      .dark-mode #userName,
      .dark-mode h3,
      .dark-mode h4 {
        color: #ffffff;
        text-shadow: 0 0 8px rgba(96, 165, 250, 0.3);
      }
      .dark-mode #walletAddress,
      .dark-mode #balanceDisplay,
      .dark-mode #safetyResult,
      .dark-mode #safetyStatus,
      .dark-mode #safetyScore,
      .dark-mode #safetyWarnings,
      .dark-mode #ppBalance,
      .dark-mode #pidogeBalance,
      .dark-mode #piBalance,
      .dark-mode #withdrawStatus,
      .dark-mode #checkInStatus,
      .dark-mode .text-sm {
        color: #a0aec0;
      }
      .dark-mode a {
        color: #60a5fa;
      }

      /* Glassmorphism Effect for Cards */
      .card {
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }

      /* Button Ripple Effect */
      .btn {
        position: relative;
        overflow: hidden;
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .btn:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }
      .btn::after {
        content: "";
        position: absolute;
        background: rgba(255, 255, 255, 0.3);
        width: 100px;
        height: 100px;
        border-radius: 50%;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(0);
        transition: transform 0.4s ease;
      }
      .btn:active::after {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0;
      }

      /* Spinner Animation */
      .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #60a5fa;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        animation: spin 1s linear infinite;
        display: none;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      /* Safety Status Colors */
      .safe {
        color: #2ecc71;
        text-shadow: 0 0 8px rgba(46, 204, 113, 0.4);
      }
      .unsafe {
        color: #e74c3c;
        text-shadow: 0 0 8px rgba(231, 76, 60, 0.4);
      }

      /* Modal Animation */
      .modal.show {
        opacity: 1;
        transform: scale(1);
      }
      .modal .modal-content {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(12px);
        transform: scale(0.8);
        transition: transform 0.3s ease, opacity 0.3s ease;
      }
      .modal.show .modal-content {
        transform: scale(1);
        opacity: 1;
      }

      /* Toast Animation */
      #toast.show {
        transform: translateX(0);
        opacity: 1;
      }
      #toast {
        transition: transform 0.3s ease, opacity 0.3s ease;
        transform: translateX(100%);
        opacity: 0;
      }

      /* Input Focus Animation */
      input:focus,
      select:focus {
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.4);
        border-color: #6366f1;
      }

      /* Chatbox Styles */
      .chatbox {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 350px;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        display: none;
        flex-direction: column;
        height: 500px;
        transition: transform 0.3s ease;
      }
      .chatbox:hover {
        transform: translateY(-5px);
      }
      .chat-header {
        background: #4a5568;
        color: white;
        padding: 10px;
        border-top-left-radius: 10px;
        border-top-right-radius: 10px;
        cursor: pointer;
        transition: background 0.3s ease;
      }
      .chat-header:hover {
        background: #2d3748;
      }
      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
        background: #f7fafc;
      }
      .message {
        margin: 5px 0;
        padding: 8px;
        border-radius: 5px;
        max-width: 70%;
      }
      .user-message {
        background: #edf2f7;
        margin-left: auto;
      }
      .bot-message {
        background: #e2e8f0;
      }
      .chat-input {
        display: flex;
        padding: 10px;
        border-top: 1px solid #e2e8f0;
      }
      .chat-input input {
        flex: 1;
        padding: 8px;
        border: 1px solid #e2e8f0;
        border-radius: 5px;
        margin-right: 10px;
        transition: box-shadow 0.3s ease;
      }
      .chat-input input:focus {
        box-shadow: 0 0 10px rgba(99, 102, 241, 0.4);
        border-color: #6366f1;
      }
      .chat-input button {
        padding: 8px 15px;
        background: #4a5568;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background 0.3s ease;
      }
      .chat-input button:hover {
        background: #2d3748;
      }

      /* Chat Icon Styles */
      .chat-icon {
        position: fixed;
        bottom: 20px;
        right: 20px;
        width: 80px;
        height: 80px;
        background: url('https://via.placeholder.com/80?text=Chatbot') no-repeat center;
        background-size: cover;
        border-radius: 50%;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        cursor: pointer;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .chat-icon:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
      }
      .chat-icon-tooltip {
        position: absolute;
        bottom: 100%;
        right: 0;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-size: 12px;
        opacity: 0;
        transition: opacity 0.3s ease;
        pointer-events: none;
        max-width: 150px;
        text-align: right;
      }
      .chat-icon-tooltip.show {
        opacity: 1;
      }
      .chat-icon-tooltip .line {
        display: block;
        margin-bottom: 3px;
      }
      .chat-icon:hover .chat-icon-tooltip {
        opacity: 1;
      }
    </style>
  </head>
  <body
    class="min-h-screen font-sans text-gray-800 transition-colors duration-500"
  >
    <div class="container mx-auto p-4 max-w-md">
      <!-- Dark Mode Toggle -->
      <div class="flex justify-end mb-4">
        <button
          id="darkModeToggle"
          class="bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors btn"
        >
          Chuyển chế độ tối
        </button>
      </div>

      <!-- Toast Notification -->
      <div
        id="toast"
        class="fixed top-4 right-4 bg-green-500 text-white py-2 px-4 rounded-lg shadow-lg"
      >
        <span id="toastMessage"></span>
      </div>

      <!-- Card Section -->
      <div
        class="card shadow-xl rounded-2xl p-6 mb-6"
      >
        <div class="flex items-center mb-4">
          <img
            id="avatar"
            src="https://via.placeholder.com/80"
            alt="Avatar"
            class="w-16 h-16 rounded-full mr-4 border-2 border-indigo-200 transition-transform duration-300 hover:scale-110"
          />
          <div class="flex-1">
            <h2 id="userName" class="text-xl font-bold">Tên của bạn</h2>
          </div>
        </div>
        <div class="mb-4">
          <p class="text-sm text-gray-500">
            Ví:
            <span id="walletAddress" class="break-words text-sm text-gray-500"
              >Chưa nhập địa chỉ ví</span
            >
          </p>
          <p class="text-sm text-gray-500 mt-1">
            Số dư: <span id="balanceDisplay">Chưa kiểm tra</span>
          </p>
        </div>
        <div class="flex space-x-2">
          <button
            onclick="copyWalletAddress()"
            class="flex-1 bg-indigo-500 text-white py-2 rounded-lg btn hover:bg-indigo-600"
          >
            Sao chép ví
          </button>
          <button
            onclick="checkBalance()"
            class="flex-1 bg-green-500 text-white py-2 rounded-lg btn hover:bg-green-600"
          >
            Kiểm tra số dư
          </button>
        </div>
      </div>

      <!-- Chart Section (TradingView Widget) -->
      <div
        class="card shadow-xl rounded-2xl p-6 mb-6"
      >
        <h3 class="text-lg font-bold mb-4">Giá Pi (USD)</h3>
        <div id="tradingview_chart"></div>
      </div>

      <!-- Safety Check Section -->
      <div
        class="card shadow-xl rounded-2xl p-6 mb-6"
      >
        <h3 class="text-lg font-bold mb-4">Kiểm tra Web/Ứng dụng</h3>
        <select
          id="checkType"
          class="w-full p-2 border rounded mb-4 focus:ring-2 focus:ring-indigo-300 transition-all duration-200"
        >
          <option value="website">Trang web</option>
          <option value="app">Ứng dụng</option>
        </select>
        <input
          id="safetyUrl"
          type="text"
          class="w-full p-2 border rounded mb-4 focus:ring-2 focus:ring-indigo-300 transition-all duration-200"
          placeholder="Nhập URL (ví dụ: https://example.com hoặc link Google Play)"
        />
        <div class="flex space-x-2">
          <button
            onclick="checkSafety()"
            id="checkButton"
            class="flex-1 bg-indigo-500 text-white py-2 rounded-lg btn hover:bg-indigo-600"
          >
            Kiểm tra
          </button>
          <button
            onclick="clearForm()"
            class="flex-1 bg-gray-300 text-gray-800 py-2 rounded-lg btn hover:bg-gray-400"
          >
            Xóa
          </button>
        </div>
        <div id="loadingSpinner" class="spinner mx-auto mt-4"></div>
        <div id="safetyResult" class="mt-4 hidden">
          <p class="text-sm font-bold flex items-center">
            Kết quả: <span id="safetyStatus" class="ml-2"></span>
            <svg
              id="statusIcon"
              class="w-5 h-5 ml-2"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 13l4 4L19 7"
              />
            </svg>
          </p>
          <p class="text-sm">
            Điểm tin cậy: <span id="safetyScore"></span>/100
          </p>
          <p class="text-sm">Cảnh báo: <span id="safetyWarnings"></span></p>
        </div>
      </div>

      <!-- Support Section -->
      <div
        class="card shadow-xl rounded-2xl p-6"
      >
        <h3 class="text-lg font-bold mb-4">Hỗ trợ</h3>
        <p class="text-sm text-gray-600 mb-2">
          Liên hệ:
          <a
            href="mailto:support@example.com"
            class="text-indigo-500 hover:underline"
            >support@example.com</a
          >
        </p>
        <p class="text-sm text-gray-600 mb-4">
          Hotline:
          <a href="tel:+84987654321" class="text-indigo-500 hover:underline"
            >+84 987 654 321</a
          >
        </p>
        <h4 class="text-md font-bold mb-2">Video hướng dẫn</h4>
        <div class="relative" style="padding-top: 56.25%">
          <iframe
            class="absolute top-0 left-0 w-full h-full rounded-lg"
            src="https://www.youtube.com/embed/dQw4w9WgXcQ"
            title="Hướng dẫn sử dụng ví Pi"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen
          ></iframe>
        </div>
      </div>

      <!-- Withdraw Modal -->
      <div
        id="withdrawModal"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden modal"
      >
        <div
          class="modal-content rounded-lg p-6 w-11/12 max-w-sm"
        >
          <h3 class="text-lg font-bold mb-4">Rút Pi</h3>
          <p class="text-sm text-gray-600 mb-4">
            Số dư hiện tại: <span id="withdrawBalance">0 Pi</span>
          </p>
          <input
            id="withdrawAmount"
            type="number"
            step="0.01"
            min="0"
            class="w-full p-2 border rounded mb-4 focus:ring-2 focus:ring-indigo-300 transition-all duration-200"
            placeholder="Số lượng Pi (tối thiểu 1$)"
          />
          <input
            id="withdrawPassword"
            type="password"
            class="w-full p-2 border rounded mb-4 focus:ring-2 focus:ring-indigo-300 transition-all duration-200"
            placeholder="Nhập mật khẩu"
          />
          <div class="flex justify-end space-x-2">
            <button
              onclick="hideWithdrawModal()"
              class="bg-gray-300 text-gray-800 py-2 px-4 rounded btn hover:bg-gray-400"
            >
              Hủy
            </button>
            <button
              onclick="withdrawPi()"
              class="bg-red-500 text-white py-2 px-4 rounded btn hover:bg-red-600"
            >
              Rút
            </button>
          </div>
        </div>
      </div>

      <!-- Chatbox -->
      <div class="chatbox" id="chatbox">
        <div class="chat-header" onclick="toggleChat()">Chatbot <span id="chatStatus"> (Đóng)</span></div>
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
          <input type="text" id="chatInput" placeholder="Nhập tin nhắn..." />
          <button onclick="sendMessage()">Gửi</button>
        </div>
      </div>
    </div>

    <!-- Chat Icon -->
    <div onclick="toggleChat()" class="chat-icon">
      <div class="chat-icon-tooltip" id="chatTooltip">
        <span class="line">Bấm vào tôi</span>
        <span class="line">để đặt câu hỏi!</span>
      </div>
    </div>

    <!-- Inline JavaScript -->
    <script>
      // Danh sách dữ liệu thành viên
      const memberData = {
        "001": {
          name: "HOÀNG VĂN MINH ",
          avatar: "https://bom.so/gmB6v2",
          wallet_address:
            "GAB3DTZTDHAQQ2IXO4RDPMYQY3CNZABM6ZGK4HWK55QKRQ6W6QCKRSDQ",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GAB3DTZTDHAQQ2IXO4RDPMYQY3CNZABM6ZGK4HWK55QKRQ6W6QCKRSDQ",
        },
        "002": {
          name: "LÊ VĂN HOẰNG",
          avatar:
            "https://cdn-ilcbnhb.nitrocdn.com/eyWebYtfntWmnihDSZRZvIqipddxdlOp/assets/images/optimized/rev-0a2b4a3/minepi.com/wp-content/uploads/2022/06/b7-1536x864.jpg",
          wallet_address:
            "GCVBQP2M5AWPLHFLUWX7ZRSE24INWWYEYC2EI3NPQWXIL5WVXXZITGJP",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GCVBQP2M5AWPLHFLUWX7ZRSE24INWWYEYC2EI3NPQWXIL5WVXXZITGJP",
        },
        "003": {
          name: "PHẠM THỊ XUÂN",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/333513902_1932195023807300_1163851942859129592_n.jpg?_nc_cat=110&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeEHUbUzai7uybMKKCX41vePUHHOaW9qRuVQcc5pb2pG5TMcLbXM7749XtjmZxexAOiueFtBjmWgkEO3QyI37KQg&_nc_ohc=2welsrt2YlMQ7kNvwFOc7hn&_nc_oc=Adk_sEaoXH3oRXMqnoqfoFZUJeW51zk8C1kGlxqHXsw4ssAxOaotBjRCgMthjIawAkRMVzySEDrzJzpaMu857opF&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=fbVmX5ala3m2lS9mp2CWoA&oh=00_AfHdYB0zfaTS4NOm24PhuUW9b6Un0nwF_rlNw0Uz3HPn-w&oe=6810E999",
          wallet_address:
            "GBDUXC2JUGEVI7N2NGLXB6B3VMUUVNUK6QI4TL5XIB2LIY3U7CDGK3B4",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GBDUXC2JUGEVI7N2NGLXB6B3VMUUVNUK6QI4TL5XIB2LIY3U7CDGK3B4",
        },
        "004": {
          name: "LÊ THỊ HƯƠNG",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/491577955_1189938295959905_8489318223622425228_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_eui2=AeEKaNmN3EMNo5OPTJm-RTXghTawRiFc5_WFNrBGIVzn9Ru16jvb4yNoeTmWk3xiLZ9qkucZiptZAKXVCXh6-qhQ&_nc_ohc=XsGUn2tjS18Q7kNvwGmpi4-&_nc_oc=AdmTx9BTl2UKWp94btd4tMJRKnEbS5WceXszgrJ_EZgbxBXUsFgK8IDuYfMrcCQbyrRhC1MBxsVRSGZA852cw4sz&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=9yomIWlBUAh83U6ENEt4Kw&oh=00_AfFb9s9k0xdsMtfF4H9cXikQXb4JxZlHTA7yZQZsz12g6g&oe=6810B70E",
          wallet_address:
            "GCWRIG2I5BNCTN5HXSMAYPQC45MRY7BQFX6AUUPAKTGACFZLBDGJG7I3",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GCWRIG2I5BNCTN5HXSMAYPQC45MRY7BQFX6AUUPAKTGACFZLBDGJG7I3",
        },
        "005": {
          name: "LÊ TRỌNG KHOA",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/493192748_1733657324175687_1257877052875128746_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=127cfc&_nc_eui2=AeH8XsKzNXgL0yj8z53qHIOtaVJWQIRCD6FpUlZAhEIPoWvV_ysyrHvZPL6RcheGuoJ6PVB5QKk-G0NLasDmDZJg&_nc_ohc=7Px-qfQ5lWQQ7kNvwHYVFhk&_nc_oc=AdlpfYi2vi89mFfK7IPldFASnOFj3koz62XDT8UC5Q0xUTR_aY3SwcSCDv5Fup1zqqo_quOvwDEk_C4sHs19Purs&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=exEYcb5mTNsTiCTOXVZr6A&oh=00_AfEs3ZBU6la6YyE0i-PZlOEDbZRw69eU9zOT7VJbJtg3ng&oe=6810F531",
          wallet_address:
            "GDMBS366RAH5STHNFCH3QWLV4VNK2U77TGFU7WEG66ZFGMHGOWZCHDOZ",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GDMBS366RAH5STHNFCH3QWLV4VNK2U77TGFU7WEG66ZFGMHGOWZCHDOZ",
        },
        "006": {
          name: "HOÀNG VĂN TRỤ",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/493108752_1733753667499386_17622212115165894_n.jpg?_nc_cat=106&ccb=1-7&_nc_sid=127cfc&_nc_eui2=AeFWkb5oRJIywNLPIbarT4xAsXKWT3Q0IG2xcpZPdDQgbZLWj82Oe1iFMByWKW-T1pN3-jkNFbqcGzuCvZA8kwfw&_nc_ohc=u3JjcYuZ3HUQ7kNvwFpJuhS&_nc_oc=AdnqHLjnrpmTiBtX9uIlyjCnXBRxMsXfixwUT9c2OQBZ65Z53aC8PNtiiKH5fRaiIpOjQLtXWgkDjLJAjvGRde_Uhh&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=PzpxmMuS2kTQyGk6q2qdbA&oh=00_AfHffHzmd2bPGcBrxcl7rtaT_HjpOuDn-SSyVnUYJ2ClXQ&oe=68113600",
          wallet_address:
            "GC4QQVU6A4EWTNCW4235WUOQ5FHKBOF57RKO2EPTIXDJKRYTLXZOHSGN",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GC4QQVU6A4EWTNCW4235WUOQ5FHKBOF57RKO2EPTIXDJKRYTLXZOHSGN",
        },
        "007": {
          name: "MINH TRANG",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/459020914_2207803129648889_9083612727790770567_n.jpg?_nc_cat=103&ccb=1-7&_nc_sid=6ee11a&_nc_eui2=AeEJB1D7cb229eMaz1Tnljv37WSJkrt-6NXtZImSu37o1VVf19czvRfBbJtbDj5OR34CVLCU34_-69wPg090ODaa&_nc_ohc=lzre0bmBz-AQ7kNvwE7BfJp&_nc_oc=Adm9GKxGty-0Z42FQwYm0_uwI8Nd409RtQMch6rxOMi7eABoW5Mt6sByJdjrKm7jv_u_o5n4wbAmAZfr__fPcBGs&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=N5PB6m8Jb2AphoVgDZwqCQ&oh=00_AfFrra6S7brzwMX_b23hAUnqPa4gQxdUkMUNMJFz49RlsQ&oe=68126FF6",
          wallet_address:
            "GD7M2UZCORSH4AJUJJN2V56MAA33OCIMYMRJ6OXMBQPG5T2FJ4OZ6TA6",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GD7M2UZCORSH4AJUJJN2V56MAA33OCIMYMRJ6OXMBQPG5T2FJ4OZ6TA6",
        },
        "008": {
          name: "LÊ THỊ HÀ",
          avatar:
            "https://scontent.fthd2-4.fna.fbcdn.net/v/t39.30808-6/491397391_122228848976217325_5812334186522958901_n.jpg?_nc_cat=101&ccb=1-7&_nc_sid=833d8c&_nc_eui2=AeGkgyQ87OtvNEhgg2G8NL2rwhyzNJKY4HbCHLM0kpjgdghCH501spAOZjH5JdhPl-dGkXQHUToUb8AsZm2_pr4h&_nc_ohc=CDt9Dj35ZmEQ7kNvwHzjhmP&_nc_oc=Adk5SG-e19biNbTLAauHy1rlHbBax96hK7tKu4v4hXaNEbwV_vznFKPrRGztEP1t8zDHFjJVjcBmGK3EGKf22QnV&_nc_zt=23&_nc_ht=scontent.fthd2-4.fna&_nc_gid=g6gl2ukwn3CLEAWEJSh_Hw&oh=00_AfE4YYjuD-c8SpfzVNTIwNnF3Cn-6yPM69g9RRmnTrrp1g&oe=6813C792",
          wallet_address:
            "GAL4V2DVKA437NPZT2B6NEQA7AJ4BE53OCKQUXNJ44G3Z3IJF3BGZ7SS",
          explorer_link:
            "https://blockexplorer.minepi.com/mainnet/accounts/GAL4V2DVKA437NPZT2B6NEQA7AJ4BE53OCKQUXNJ44G3Z3IJF3BGZ7SS",
        },
      };

      // Show Toast Notification
      function showToast(message, type = "success") {
        const toast = document.getElementById("toast");
        const toastMessage = document.getElementById("toastMessage");
        toastMessage.textContent = message;
        toast.classList.remove("bg-green-500", "bg-red-500");
        toast.classList.add(type === "success" ? "bg-green-500" : "bg-red-500");
        toast.classList.remove("hidden");
        toast.classList.add("show");
        setTimeout(() => {
          toast.classList.remove("show");
          toast.classList.add("hidden");
        }, 3000);
      }

      // Load user data based on tag_id
      function loadUserData() {
        const urlParams = new URLSearchParams(window.location.search);
        const tagId = urlParams.get("tag_id");
        const userName = document.getElementById("userName");
        const walletAddress = document.getElementById("walletAddress");
        const avatar = document.getElementById("avatar");

        if (tagId && memberData[tagId]) {
          const member = memberData[tagId];
          userName.textContent = member.name;
          walletAddress.textContent = member.wallet_address;
          avatar.src = member.avatar;
        } else {
          userName.textContent = "Không tìm thấy thông tin";
          walletAddress.textContent = "Không tìm thấy địa chỉ ví";
          avatar.src = "https://via.placeholder.com/80";
        }
      }

      // Auto-check balance from URL
      function autoCheckBalanceFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        const walletAddress = urlParams.get("wallet");
        if (walletAddress) {
          document.getElementById("walletAddress").textContent = walletAddress;
          checkBalance();
        }
      }

      // Check Balance (Redirect to Pi Block Explorer)
      function checkBalance() {
        const walletAddress =
          document.getElementById("walletAddress").textContent;

        if (!walletAddress || walletAddress === "Không tìm thấy địa chỉ ví") {
          showToast("Không có địa chỉ ví để kiểm tra!", "error");
          return;
        }

        const explorerUrl = `https://blockexplorer.minepi.com/mainnet/accounts/${walletAddress}`;
        window.location.href = explorerUrl;
      }

      // Show Withdraw Modal
      function showWithdrawModal() {
        const withdrawModal = document.getElementById("withdrawModal");
        withdrawModal.classList.remove("hidden");
        withdrawModal.classList.add("show");
      }

      // Hide Withdraw Modal
      function hideWithdrawModal() {
        const withdrawModal = document.getElementById("withdrawModal");
        withdrawModal.classList.remove("show");
        withdrawModal.classList.add("hidden");
      }

      // Withdraw Pi (Mock)
      function withdrawPi() {
        const amount = parseFloat(
          document.getElementById("withdrawAmount").value
        );
        const password = document.getElementById("withdrawPassword").value;

        if (!amount || amount < 0.01) {
          showToast("Số lượng Pi phải lớn hơn 0 và tối thiểu 1$!", "error");
          return;
        }

        if (!password) {
          showToast("Vui lòng nhập mật khẩu!", "error");
          return;
        }

        setTimeout(() => {
          showToast("Yêu cầu rút Pi đã được gửi!");
          hideWithdrawModal();
        }, 1500);
      }

      // Safety Check (Mock)
      function checkSafety() {
        const checkButton = document.getElementById("checkButton");
        const loadingSpinner = document.getElementById("loadingSpinner");
        const safetyResult = document.getElementById("safetyResult");
        const safetyStatus = document.getElementById("safetyStatus");
        const safetyScore = document.getElementById("safetyScore");
        const safetyWarnings = document.getElementById("safetyWarnings");

        checkButton.disabled = true;
        loadingSpinner.style.display = "block";
        safetyResult.classList.add("hidden");

        setTimeout(() => {
          loadingSpinner.style.display = "none";
          safetyResult.classList.remove("hidden");

          const isSafe = Math.random() > 0.5;
          safetyResult.classList.remove("safe", "unsafe");
          safetyResult.classList.add(isSafe ? "safe" : "unsafe");
          safetyStatus.textContent = isSafe ? "An toàn" : "Không an toàn";
          safetyScore.textContent = isSafe ? "85" : "30";
          safetyWarnings.textContent = isSafe
            ? "Không có cảnh báo"
            : "Trang web có thể không đáng tin cậy";

          checkButton.disabled = false;
          showToast(
            isSafe
              ? "Kiểm tra thành công: An toàn!"
              : "Kiểm tra thành công: Không an toàn!",
            isSafe ? "success" : "error"
          );
        }, 1500);
      }

      // Clear Safety Check Form
      function clearForm() {
        document.getElementById("safetyUrl").value = "";
        document.getElementById("safetyResult").classList.add("hidden");
        showToast("Đã xóa biểu mẫu!");
      }

      // Dark Mode Toggle
      document
        .getElementById("darkModeToggle")
        .addEventListener("click", () => {
          document.body.classList.toggle("dark-mode");
          const isDarkMode = document.body.classList.contains("dark-mode");
          document.getElementById("darkModeToggle").textContent = isDarkMode
            ? "Chuyển chế độ sáng"
            : "Chuyển chế độ tối";
          localStorage.setItem("darkMode", isDarkMode ? "enabled" : "disabled");
        });

      // Chatbot Functions
      const chatbox = document.getElementById("chatbox");
      const chatMessages = document.getElementById("chatStatus");
      const chatInput = document.getElementById("chatInput");
      const chatMessagesDiv = document.getElementById("chatMessages");

      function toggleChat() {
        chatbox.style.display = chatbox.style.display === "flex" ? "none" : "flex";
        document.getElementById("chatStatus").textContent = chatbox.style.display === "flex" ? " (Mở)" : " (Đóng)";
      }

      function addMessage(message, isUser = false) {
        const messageDiv = document.createElement("div");
        messageDiv.className = `message ${isUser ? "user-message" : "bot-message"}`;
        messageDiv.textContent = message;
        chatMessagesDiv.appendChild(messageDiv);
        chatMessagesDiv.scrollTop = chatMessagesDiv.scrollHeight;
      }

      async function sendMessage() {
        const message = chatInput.value.trim();
        if (!message) return;

        addMessage(message, true);
        chatInput.value = "";

        try {
          const response = await fetch(`https://api.wit.ai/message?v=20240504&q=${encodeURIComponent(message)}`, {
            headers: {
              'Authorization': 'Bearer YOUR_WIT_AI_SERVER_TOKEN' // Thay YOUR_WIT_AI_SERVER_TOKEN bằng token của bạn
            }
          });
          const data = await response.json();

          let botResponse = "Tôi không hiểu rõ, bạn có thể hỏi lại không? Ví dụ: 'Điểm danh', 'Đổi PP', hoặc 'Rút Pi'";
          if (data.intents.length > 0 && data.intents[0].confidence > 0.7) {
            const intent = data.intents[0].name;
            const urlParams = new URLSearchParams(window.location.search);
            const tagId = urlParams.get("tag_id");

            switch (intent) {
              case 'greeting':
                botResponse = "Chào bạn! Tôi là chatbot của Ví Pi. Bạn cần giúp gì không?";
                break;
              case 'checkin':
                botResponse = "Để điểm danh, nhấn nút 'Điểm danh' (nếu có) hoặc kiểm tra với tag_id của bạn. Bạn nhận 5 PP mỗi ngày!";
                break;
              case 'convert_pp':
                botResponse = "Bạn cần 300 PP để đổi 1 Pi. Nhấn 'Đổi PP → Pi' (nếu có) để thực hiện!";
                break;
              case 'withdraw_pi':
                botResponse = "Để rút Pi, nhấn 'Rút Pi', nhập số lượng (tối thiểu 1$) và mật khẩu. Yêu cầu sẽ được xử lý!";
                break;
              case 'help':
                botResponse = "Tôi có thể giúp bạn với: điểm danh, đổi PP, rút Pi. Hãy thử hỏi nhé!";
                break;
              case 'check_balance':
                if (tagId && memberData[tagId]) {
                  botResponse = `Địa chỉ ví của bạn là: ${memberData[tagId].wallet_address}. Vui lòng kiểm tra số dư tại ${memberData[tagId].explorer_link}`;
                } else {
                  botResponse = "Vui lòng cung cấp tag_id hợp lệ để kiểm tra số dư!";
                }
                break;
              default:
                botResponse = "Xin lỗi, tôi chưa hiểu. Bạn có thể hỏi về điểm danh, đổi PP, rút Pi, hoặc kiểm tra số dư không?";
            }
          }
          setTimeout(() => addMessage(botResponse), 500);
        } catch (error) {
          addMessage("Có lỗi xảy ra. Vui lòng thử lại sau.", false);
        }
      }

      chatInput.addEventListener("keypress", (e) => {
        if (e.key === "Enter") sendMessage();
      });

      // Initialize on page load
      document.addEventListener("DOMContentLoaded", () => {
        loadUserData();
        autoCheckBalanceFromURL();

        const darkModePreference = localStorage.getItem("darkMode");
        if (darkModePreference === "enabled") {
          document.body.classList.add("dark-mode");
          document.getElementById("darkModeToggle").textContent = "Chuyển chế độ sáng";
        }

        // Initialize TradingView Widget
        new TradingView.widget({
          width: "100%",
          height: 300,
          symbol: "OKX:PIUSDT",
          interval: "D",
          timezone: "Etc/UTC",
          theme: "light",
          style: "1",
          locale: "en",
          toolbar_bg: "#f1f3f6",
          enable_publishing: false,
          allow_symbol_change: true,
          container_id: "tradingview_chart",
        });

        addMessage("Chào bạn! Tôi là chatbot của Ví Pi. Hãy nhắn tin để tôi hỗ trợ!");

        // Show chat tooltip after 5 seconds, hide after 5 more seconds
        const chatTooltip = document.getElementById("chatTooltip");
        setTimeout(() => {
          chatTooltip.classList.add("show");
          setTimeout(() => {
            chatTooltip.classList.remove("show");
          }, 5000);
        }, 5000);
      });

      // Copy Wallet Address
      function copyWalletAddress() {
        const walletAddress =
          document.getElementById("walletAddress").textContent;
        if (walletAddress === "Không tìm thấy địa chỉ ví") {
          showToast("Không có địa chỉ ví để sao chép!", "error");
          return;
        }
        navigator.clipboard
          .writeText(walletAddress)
          .then(() => {
            showToast("Đã sao chép địa chỉ ví!");
          })
          .catch(() => {
            showToast("Không thể sao chép địa chỉ ví!", "error");
          });
      }
    </script>
  </body>
</html>
